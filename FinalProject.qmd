---
title: "Air Pollution Across the Globe"
author: "Sneha Arya, Greer Moran, and Gabrielle Smeltzer"
date: "April 24, 2025"
date-modified: now
format:
  pdf:
    toc: false
    number-sections: false
    number-depth: 5
    fig-align: center
    cap-location: top
    geometry:
      - top=1in
      - left=1in
      - right=1in
      - bottom=1in
    colorlinks: true
nocite: |
  @*
csl: MLA9.csl
execute:
  echo: false
  warning: false
---

# **Research Topic: Air Pollution Across the Globe**

This research focuses on air pollution across the globe, a topic that directly impacts society's health, the climate, and quality of life. As pollution levels are rising exponentially worldwide, it is vital to understand relationships between population distribution and the severity of air pollution. Using a main dataset regarding Global Air Quality and a secondary dataset on global city-level populations, our research centers on observing pollution and population data to explore these patterns. Since population values in our secondary dataset were provided by city, we aggregated them to generate total population figures by country. We chose to visualize data at the country level to reduce clutter and improve clarity among visualizations, allowing for a more accessible and focused exploration of global air pollution patterns.

# **Research Questions**

<<<<<<< Updated upstream
To guide our analysis, our team develops a set of research questions focused on identifying key relationships between population and pollution levels. One area of focus is how population contributes to pollution across a select six countries. In designing this study, we prioritize ethical data practices by applying the FAIR (Findable, Accessible, Interoperable, Reusable) and CARE (Collective Benefit, Authority to Control, Responsibility, Ethics) principles. We consider collective benefit by aiming for findings that can have a global impact and uphold responsibility by avoiding selection bias. To promote inclusivity and neutrality, we select one country per continent (Australia, Brazil, Canada, China, France, and South Africa) using a random name generator, excluding Antarctica due to its low population.
Another central focus of our project is investigating how specific pollutant values (Carbon Monoxide, Ozone, Nitrogen Dioxide, and Particulate Matter) contribute to a country's overall Air Quality Index (AQI). To explore this, we apply linear regression modeling and plan to visualize the results through a regression summary table and a slope plot illustrating each pollutantâ€™s influence on AQI. In addition, we plan to use faceted scatter plots to compare pollutant values to AQI, offering a clear view of how each variable individually correlates with air quality.

We also aim to examine whether urban population percentage plays a role in pollution severity. To do this, we plan to implement a histogram visualization that compares AQI value distributions in relation to levels of urban population across the six countries, helping us identify patterns linked to urbanization. Furthermore, we use a grouped bar graph to present the frequency of AQI categories by country, enabling straightforward comparisons of pollution severity across regions. Lastly, we analyze ozone AQI values in relation to land area through a boxplot to explore how physical geography may intersect with pollution levels.

Overall, this is not an exhaustive list of the questions we aim to explore, as the dataset contains many overlapping features that may reveal new insights. Our goal is to use structured analysis and clear, accessible visualizations to better understand global air quality trends and their potential implications for effects on the environment and public health.


## Plan

1.  Load/get needed packages in an R Chunk
2.  Read csv
3.  Use {dplyr} package to use rename() to replace column names
4.  Get linear regression model using () and summary()
5.  Go to Dr.Hatfield and ask how to clean summary() and use kableExtra

```{r}
#| label: packages-loaded

# Load needed packages ---
## Must determine which are used in our code so that it is executed


library(tidyverse)
library(googlesheets4)
library(knitr)
library(kableExtra)
library(dcData)
library(tinytex)
library(dplyr)
library(ggplot2)
```

```{r}

#| label: Data Wrangling Code for Global Air Pollution
#| lst-label: Global Air Pollution, Data Wrangling
#| lst-cap: "Rename Needed Columns"


# Wrangle Air Pollution Data ---

## Get Correct Column Names ---
### Get Specific Data Frame of Correct Column Names


globalData <- read.csv("statproject.csv")

cleanAQIdata <- globalData %>%
  rename(c(
    AQI = "AQI.Value",
    CO = "CO.AQI.Value",
    Ozone = "Ozone.AQI.Value",
    NO2 = "NO2.AQI.Value",
    PM = "PM2.5.AQI.Value"
    )
    )

aqiModel <- lm(AQI ~ CO + Ozone + NO2 + PM, data = cleanAQIdata)
aqiSummary <- summary(aqiModel)


```

```{r}
#| label: tab:regression-visual
# Create Table Summary Visualization ---

aqiModel <- as.data.frame(aqiSummary$coefficients) ## create data frame
aqiModel$Pollutant <- rownames(aqiModel)
aqiModel <- aqiModel[, c("Pollutant", "Estimate", "Std. Error", "t value", "Pr(>|t|)")]
colnames(aqiModel) <- c("Pollutant", "Est. Slope", "Std. Error", "t value", "p-value")
rownames(aqiModel) <- NULL

kable(
  aqiModel,
  caption = "Linear Regression Summary for Pollutants impact on AQI",
  digits = 5,
  format = "latex"
  ) %>%
  kable_styling(
    position = "center"
  )

```

```{r}
#| label: fig-AQIModel
# 
print(
ggplot(
  data = aqiModel, 
  mapping = aes(
    x = reorder(Pollutant, `Est. Slope`), 
    y = `Est. Slope`,
    color = Pollutant
    )
  ) +
  geom_point(
    size = 3
    ) +
  labs(
    title = "Pollutant Influence on Air Quality Index",
    x = "Pollutant",
    y = "Slope Measure"
  ) +
  scale_color_manual(
    values = c("black", "steelblue", "yellow3", "purple3", "red3")
  )
  + theme_minimal()
)

```

```{r}
#| label: fig-PollutantValue
# AQI Value by Pollutant Value Data Frame
## Tidy data frame so that Pollutant is a column
  
tidyAQIdf <- cleanAQIdata %>%
  pivot_longer(
    cols = c(
      CO,
      Ozone,
      NO2,
      PM
    ),
    names_to = "Pollutant",
    values_to = "Pollutant_Value"
  )

#AQI Value by Pollutant Value Scatterplots
## Create facetted scatterplots using ggplot2

ggplot(
  data = tidyAQIdf,
  mapping = aes(
    x = Pollutant_Value,
    y = AQI,
    color = Pollutant
    )
  )+
    geom_point() +
    facet_wrap(~ Pollutant, scales = "free_x") +
    labs(
      title = "Value of Pollutant on AQI Measure",
      x = "Pollutant Value",
      y = "Air Quality Index (AQI) Value"
    ) +
    scale_color_manual(
      values = c("steelblue", "yellow3", "purple3", "red3")) +
    theme_minimal()
```

# An Analysis of Air Quality

```{r}
#| label: SpecificCountry


## Create space for population and pollution data
pollutionData <- read.csv("statproject.csv")
populationData <-read.csv("statproject1.csv")

## Wrangle the data for calling and combination
## Combine the data for population
populationPollution <-left_join(
  x = pollutionData,
  y = populationData,
  by = join_by(Country == 'Country..or.dependency.')
)


##Filter out all cities without population

tidypopPoll <- populationPollution %>%

filter(if_all(Population..2020., ~ !is.na(.)))

##Filter our data to a country from each continent, excluding Antarctica

filteredCountry <- c("Australia", "Brazil", "Canada", "China","France", "South Africa"  )
specificCountry <- tidypopPoll %>%  
  filter(Country %in% filteredCountry)


```

{{< pagebreak >}}

```{r}
#| label: fig-CountryAQI
##Create Comparison Visuals

ggplot(specificCountry) +
  aes(x = Country, fill = AQI.Category) +
  geom_bar() +
  scale_fill_brewer(palette = "RdPu", direction = 1) +
  labs(
    x = "Country",
    y = "Category Count",
    title = "AQI Category by Country",
    caption = "A count of each AQI category by country.",
    fill = "AQI Categories"
  ) +
  theme_linedraw() +
  theme(
    plot.title = element_text(size = 15L,
    face = "bold",
    hjust = 0.5),
    plot.caption = element_text(hjust = 0.5)
  )
 

```

{{< pagebreak >}}

```{r}
#| label: fig-UrbanpopulationAQI
specificCountry %>%
 filter(AQI.Value >= 10L & AQI.Value <= 350L) %>%
 ggplot() +
  aes(x = AQI.Value, fill = Urban.Pop..) +
  geom_histogram(bins = 30L) +
  scale_fill_hue(direction = 1) +
  labs(
    x = "AQI Value Range",
    y = "AQI Value Occurance",
    title = "Comparison of AQI Value in Relation to Urban Population"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 15L,
    face = "bold",
    hjust = 0.5)
  ) +
  facet_wrap(vars(Country))
```

<<<<<<< Updated upstream
=======
{{< pagebreak >}}

>>>>>>> Stashed changes
```{r}
#| label: fig-OzoneLandAreaRelation
ggplot(specificCountry) +
  aes(
    x = Ozone.AQI.Value,
    y = Ozone.AQI.Category,
    fill = Land.Area..Km..
  ) +
  geom_boxplot() +
  scale_fill_viridis_c(option = "plasma", direction = 1) +
  labs(
    x = "Ozone AQI Value",
    y = "Ozone Category",
    title = "Ozone Values in Relation to Land Area",
    fill = "Land Area (km)"
  ) +
  theme_gray() +
  theme(
    plot.title = element_text(size = 15L,
    face = "bold",
    hjust = 0.5),
    legend.text = element_text(face = "bold"),
    legend.title = element_text(face = "bold")
  ) +
  facet_wrap(vars(Country))


```

{{< pagebreak >}}

# Data Sources and Acknowledgement

# Code Appendix:

```{r codeAppend, ref.label=knitr::all_labels(), echo=TRUE, eval=FALSE}
```
