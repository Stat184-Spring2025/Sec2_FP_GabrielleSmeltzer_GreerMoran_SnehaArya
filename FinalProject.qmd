---
title: "Air Pollution Across the Globe"
author: "Sneha Arya, Greer Moran, and Gabrielle Smeltzer"
date: "April 24, 2025"
date-modified: now
format:
  pdf:
    toc: false
    number-sections: false
    number-depth: 5
    fig-align: center
    cap-location: top
    geometry:
      - top=1in
      - left=1in
      - right=1in
      - bottom=1in
    colorlinks: true
bibliography: references.bib
nocite: |
  @*
csl: MLA9.csl
execute:
  echo: false
  warning: false
---

# Table of Contents:

## Research Question 1

How does pollutant air quality index values (e.g. Carbon Dioxide, Ozone, Nitrogen Dioxide, and Particle Matter) impact the overall air quality index, which are most contributing to poor air quality index?

## Plan

1.  Load/get needed packages in an R Chunk
2.  Read csv
3.  Use {dplyr} package to use rename() to replace column names
4.  Get linear regression model using () and summary()
5.  Go to Dr.Hatfield and ask how to clean summary() and use kableExtra

```{r}
#| label: packages-loaded

# Load needed packages ---
## Must determine which are used in our code so that it is executed


library(tidyverse)
library(googlesheets4)
library(knitr)
library(dcData)
library(tinytex)
```

```{r}
#| label: Data Wrangling Code for Global Air Pollution
#| lst-label: Global Air Pollution, Data Wrangling
#| lst-cap: "Rename Needed Columns"


# Wrangle Air Pollution Data ---

## Get Correct Column Names ---
### Get Specific Data Frame of Correct Column Names

library(dplyr)
library(tidyverse)
globalData <- read.csv("/Users/greermoran/Downloads/globalairpollutiondataset.csv")

cleanAQIdata <- globalData %>%
  rename(c(
    AQI = "AQI.Value",
    CO = "CO.AQI.Value",
    Ozone = "Ozone.AQI.Value",
    NO2 = "NO2.AQI.Value",
    PM = "PM2.5.AQI.Value"
    )
    )

aqiModel <- lm(AQI ~ CO + Ozone + NO2 + PM, data = cleanAQIdata)
aqiSummary <- summary(aqiModel)
aqiSummary

# Create Table Summary Visualization ---

aqiDF <- as.data.frame(aqiSummary$coefficients) ## create data frame
aqiDF$Pollutant <- rownames(aqiDF)
aqiDF <- aqiDF[, c("Pollutant", "Estimate", "Std. Error", "t value", "Pr(>|t|)")]
colnames(aqiDF) <- c("Pollutant", "Est. Slope", "Std. Error", "t value", "p-value")
rownames(aqiDF) <- NULL


library(knitr)
library(kableExtra)
kable(
  aqiDF,
  caption = "Linear Regression Summary for Pollutants impact on AQI",
  digits = 5
  ) %>%
  kable_styling(
    position = "center"
  )
aqiDF

library(ggplot2)
# 
ggplot(
  data = aqiDF, 
  mapping = aes(
    x = reorder(Pollutant, `Est. Slope`), 
    y = `Est. Slope`
    )
  ) +
  geom_point(
    size = 3, 
    color = "steelblue"
    ) +
  labs(
    title = "Impact of Pollutants on Air Quality Index",
    x = "Pollutant",
    y = "Estimated Slope"
  ) +
  theme_minimal()

```

# An Analysis of Air Quality 

```{r}
library(dplyr)
library(tidyverse)
library(ggplot2)


## Create space for population and pollution data
pollutionData <- read.csv("statproject.csv")
populationData <-read.csv("statproject1.csv")

## Wrangle the data for calling and combination
## Combine the data for population
populationPollution <-left_join(
  x = pollutionData,
  y = populationData,
  by = join_by(Country == 'Country..or.dependency.')
)


##Filter out all cities without population

tidypopPoll <- populationPollution %>%

filter(if_all(Population..2020., ~ !is.na(.)))

##Filter our data to a country from each continent, excluding Antarctica

filteredCountry <- c("Australia", "Brazil", "Canada", "China","France", "South Africa"  )
specificCountry <- tidypopPoll %>%  
  filter(Country %in% filteredCountry)


```

{{< pagebreak >}}

```{r}
#| label: fig-CountryAQI
##Create Comparison Visuals

ggplot(specificCountry) +
  aes(x = Country, fill = AQI.Category) +
  geom_bar() +
  scale_fill_brewer(palette = "RdPu", direction = 1) +
  labs(
    x = "Country",
    y = "Category Count",
    title = "AQI Category by Country",
    caption = "A count of each AQI category by country.",
    fill = "AQI Categories"
  ) +
  theme_linedraw() +
  theme(
    plot.title = element_text(size = 15L,
    face = "bold",
    hjust = 0.5),
    plot.caption = element_text(hjust = 0.5)
  )
 

```

```{r}
#| label: fig-UrbanpopulationAQI
specificCountry %>%
 filter(AQI.Value >= 10L & AQI.Value <= 350L) %>%
 ggplot() +
  aes(x = AQI.Value, fill = Urban.Pop..) +
  geom_histogram(bins = 30L) +
  scale_fill_hue(direction = 1) +
  labs(
    x = "AQI Value Range",
    y = "AQI Value Occurance",
    title = "Comparison of AQI Value in Relation to Urban Population"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 15L,
    face = "bold",
    hjust = 0.5)
  ) +
  facet_wrap(vars(Country))
```

```{r}
#| label: fig-OzoneLandAreaRelation
ggplot(specificCountry) +
  aes(
    x = Ozone.AQI.Value,
    y = Ozone.AQI.Category,
    fill = Land.Area..Km..
  ) +
  geom_boxplot() +
  scale_fill_viridis_c(option = "plasma", direction = 1) +
  labs(
    x = "Ozone AQI Value",
    y = "Ozone Category",
    title = "Ozone Values in Relation to Land Area",
    fill = "Land Area (km)"
  ) +
  theme_gray() +
  theme(
    plot.title = element_text(size = 15L,
    face = "bold",
    hjust = 0.5),
    legend.text = element_text(face = "bold"),
    legend.title = element_text(face = "bold")
  ) +
  facet_wrap(vars(Country))


```

# Data Sources and Acknowledgements

# Code Appendix

```{r}
{r codeAppend, ref.label=knitr::all_labels(), echo=TRUE, eval=FALSE}
```
